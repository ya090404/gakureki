<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>クイズゲーム</title>
  <style>
    body {
      margin: 0;
      background: black;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    canvas {
      width: 100%;
      height: auto;
      max-width: 750px;
      max-height: 1334px;
      display: block;
    }
    .button, .input-box, .input-button {
      position: absolute;
      font-size: 20px;
      font-family: sans-serif;
      z-index: 2;
    }
    .button {
      background-color: pink;
      border: none;
      padding: 10px;
      width: 130px;
      color: blue;
      font-weight: bold;
    }
    #input2, #input5 {
      font-size: 20px;
      padding: 5px;
      width: 200px;
    }
  </style>
</head>
<body>
<canvas id="canvas" width="750" height="1334"></canvas>

<!-- ボタン類（すべて非表示から開始） -->
<button class="button" id="btnA" style="display:none; left:110px; top:940px;">A</button>
<button class="button" id="btnB" style="display:none; left:400px; top:940px;">B</button>
<button class="button" id="btnC" style="display:none; left:110px; top:1020px;">C</button>
<button class="button" id="btnD" style="display:none; left:400px; top:1020px;">D</button>

<button class="button" id="btnQ4A" style="display:none; left:110px; top:560px;">A</button>
<button class="button" id="btnQ4B" style="display:none; left:400px; top:560px;">B</button>
<button class="button" id="btnQ4C" style="display:none; left:110px; top:640px;">C</button>
<button class="button" id="btnQ4D" style="display:none; left:400px; top:640px;">D</button>

<input type="text" id="input2" class="input-box" style="display:none; left:180px; top:900px;" placeholder="ひらがなで入力してね">
<button id="submit2" class="input-button" style="display:none; left:400px; top:900px;">答える</button>

<input type="text" id="input5" class="input-box" style="display:none; left:180px; top:900px;" placeholder="ひらがなで入力してね">
<button id="submit5" class="input-button" style="display:none; left:400px; top:900px;">答える</button>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const images = {
  start: "start.PNG",
  girl: "girl.PNG",
  boy: "boy.PNG"
};

const quizImages = [
  "q1.png", "q2.png", "q3.png", "q4.png", "q5.png"
];

const questions = [
  { type: "choice", img: "girl.PNG", text: "日本地図:この県はどこ？", correct: "高知県", buttons: ["btnA","btnB","btnC","btnD"], labels: ["徳島県","香川県","愛媛県","高知県"] },
  { type: "input", img: "boy.PNG", text: "ひらがなで答えてね", correct: "まつやま", input: "input2", submit: "submit2" },
  { type: "choice", img: "girl.PNG", text: "この記号の名前は？", correct: "クロックタッチ", buttons: ["btnA","btnB","btnC","btnD"], labels: ["バッグ・クロージャー","バー・ロジャース","クロックタッチ","クロス・バー"] },
  { type: "choice", img: "girl.PNG", text: "A〜Dのうち答えの違うものは？\n\nA: He wants to buy __ melon.\nB: She is eating __ apple.\nC: I ate __ banana.\nD: Would you like __ peach?", correct: "B", buttons: ["btnQ4A","btnQ4B","btnQ4C","btnQ4D"], labels: ["A","B","C","D"] },
  { type: "input", img: "girl.PNG", text: "「仙人掌」の読みは？", correct: "さぼてん", input: "input5", submit: "submit5" }
];

let current = -1;
let answers = [];

function draw(img, text) {
  const image = new Image();
  image.src = img;
  image.onload = () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(image, 0, 0, canvas.width, canvas.height);
    if (text) {
      ctx.fillStyle = "white";
      ctx.font = "26px sans-serif";
      ctx.strokeStyle = "black";
      ctx.lineWidth = 2;
      const lines = text.split("\n");
      lines.forEach((line, i) => {
        ctx.strokeText(line, 50, 1100 + i * 30);
        ctx.fillText(line, 50, 1100 + i * 30);
      });
    }
  };
}

function next() {
  current++;
  hideAll();

  if (current >= questions.length) return end();

  const q = questions[current];
  draw(q.img, q.text);

  if (q.type === "choice") {
    q.buttons.forEach((btnId, i) => {
      const btn = document.getElementById(btnId);
      btn.textContent = q.labels[i];
      btn.style.display = "block";
      btn.onclick = () => {
        answers.push(q.labels[i]);
        next();
      };
    });
  } else if (q.type === "input") {
    const input = document.getElementById(q.input);
    const submit = document.getElementById(q.submit);
    input.value = "";
    input.style.display = "block";
    submit.style.display = "block";
    submit.onclick = () => {
      answers.push(input.value.trim());
      next();
    };
  }
}

function hideAll() {
  document.querySelectorAll(".button, .input-box, .input-button").forEach(e => {
    e.style.display = "none";
  });
}

function end() {
  const isAllCorrect = answers[0] === "高知県" &&
                       answers[1] === "まつやま" &&
                       answers[2] === "クロックタッチ" &&
                       answers[3] === "B" &&
                       answers[4] === "さぼてん";
  const resultText = isAllCorrect ? "トゥルーエンド！" : "バッドエンド…";
  draw("boy.PNG", resultText);
}

canvas.addEventListener("click", () => {
  if (current === -1) next();
});
draw("start.PNG");
</script>
</body>
</html>